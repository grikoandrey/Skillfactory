<!--  наследуемся от шаблона default.html, который мы создавали для flatpages -->
{% extends 'flatpages/default.html' %}

{% load add_filters %}
{% load add_tags %}

{% block title %} Posts {% endblock title %}

{% block content %}
<h1>Все новости ({{ news_count }})</h1>
<hr>
{% if posts %}
  <table>
    <tr>
        <td>Тип</td>
        <td>Категория</td>
        <td>Заголовок</td>
        <td>Дата</td>
        <td>Содержание</td>
        <td>Автор</td>
    </tr>
    {% for post in posts %}
    <tr>
        <td>{{ post.get_type_post_display }}</td>
        <td>{% for category in post.post_category.all %}
                {{ category.get_category_display }}
                {% if not forloop.last %}, {% endif %}
            {% endfor %}
        </td>
        <td> <a href="{% url 'post' pk=post.id %}" target="_blank">{{ post.title|censor }}</a></td>
        <td> {{ post.post_created_date|date:'d M Y' }}</td>
        <td>  {{ post.text|censor|truncatewords:20 }}</td>
        <td>{{ post.post_author.author_user.username }}</td>
    </tr>
    {% endfor %}
  </table>

{% else %}
    <h2>На сегодня все!</h2>
{% endif %}
{% endblock content %}